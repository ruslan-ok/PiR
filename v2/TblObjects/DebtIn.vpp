//------------------------------------------------------------------------------
//                                                      (c) Корпорация Галактика
// Заработная плата по отделу
// Окно редактирования входящего остатка
//------------------------------------------------------------------------------

Window wnDebtIn 'Входящий остаток';
  show at(,, 80, 13);

Screen scDebtIn ('',, sci178Esc);
  table mtDebtIn;
Fields
  mtStruct.Name: skip;
  mtDebtIn.dPeriod:  ['MM.YYYY'], skip;
  mtDebtIn.Sort:         noprotect;
  mtDebtIn.GetTitleName: noprotect;
  mtDebtIn.Payed:        noprotect;
  mtDebtIn.Value: [13.2,'\2p[|-]366`666`666~99'], noprotect;
  mtDebtIn.TaxCur:  [list 'BYN без налогов',
                          'BYN с налогами',
                          'USD без налогов',
                          'USD с налогами'], protect;
  mtDebtIn.NetBYN: skip;
  mtDebtIn.TaxBYN: skip;
  mtDebtIn.Rate:   [13.4,'\4p[|-]366`666~9999'], noprotect;
  mtDebtIn.NetUSD: skip;
  mtDebtIn.TaxUSD: skip;
  mtDebtIn.Info:   noprotect;
  mtDebtIn.Error:  skip;
<<

   `Сотрудник`    .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   `Период`       .@@@@@@@@@@@@              `Номер п/п`    .@@@@@@@@@@@@
   `Название`     .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
   `Дата выплаты` .@@@@@@@@@@@@
   `Сумма`        .@@@@@@@@@@@@ .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                   без налогов   с налогами
   `Сумма в BYN`  .@@@@@@@@@@@@ .@@@@@@@@@@@@
   `Курс`         .@@@@@@@@@@@@
   `Сумма в USD`  .@@@@@@@@@@@@ .@@@@@@@@@@@@
   `Комментарий`  .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
                  .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
>>
End;

End;

TableEvent
  table mtDebtIn;

cmSetDefault:
  mtDebtIn.Title := GetSumTitle(R08);

cmInsertRecord:
  insert current mtDebtIn;

cmUpdateRecord:
  update current mtDebtIn;

cmDeleteRecord:
  if (message('Удалить входящий остаток?', Confirmation + YesNo) = cmYes)
    delete current mtDebtIn;

end;
